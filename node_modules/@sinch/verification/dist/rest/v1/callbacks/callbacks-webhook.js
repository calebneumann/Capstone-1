"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.VerificationCallbackWebhooks = void 0;
const sdk_client_1 = require("@sinch/sdk-client");
class VerificationCallbackWebhooks {
    constructor(sinchClientParameters) {
        this.sinchClientParameters = sinchClientParameters;
    }
    /**
     * Validate authorization header for callback request
     * @param {IncomingHttpHeaders} headers - Incoming request's headers
     * @param {any} body - Incoming request's body
     * @param {string} path - Incoming request's path
     * @param {string} method - Incoming request's HTTP method
     * @return {boolean} - true if the authorization header is valid
     */
    validateAuthenticationHeader(headers, body, path, method) {
        if (!this.sinchClientParameters.applicationKey || !this.sinchClientParameters.applicationSecret) {
            throw new Error('The application key and secret must be defined');
        }
        return (0, sdk_client_1.validateAuthenticationHeader)(this.sinchClientParameters.applicationKey, this.sinchClientParameters.applicationSecret, headers, body, path, method);
    }
    /**
     * Reviver for a Verification Event.
     * This method ensures the object can be treated as a Verification Event and should be called before any action is taken to manipulate the object.
     * @param {any} eventBody - The event body containing the verification event notification.
     * @return {VerificationCallback} - The parsed verification event object.
     */
    parseEvent(eventBody) {
        if (eventBody.event) {
            switch (eventBody.event) {
                case 'VerificationRequestEvent':
                    return eventBody;
                case 'VerificationResultEvent':
                    return eventBody;
                default:
                    throw new Error(`Unknown Verification event type: ${eventBody.event}`);
            }
        }
        console.log(`Unknown Verification event structure:\n${JSON.stringify(eventBody)}`);
        throw new Error('Unknown Verification event');
    }
}
exports.VerificationCallbackWebhooks = VerificationCallbackWebhooks;
//# sourceMappingURL=callbacks-webhook.js.map